数学建模 笔记

## 第一章 建立数学模型

### 1.1 从现实对象到数学模型

定义：**模型**是为了一定目的，对客观事物的一部分进行简缩、抽象、提炼出来的**原型**的替代物。

分类：实物、物理、符号模型

* 模型集中反映了原型中人们需要的那一部分特征

数学建模：对于一个**现实对象**，为了一个**特定目的**，根据其**内在规律**，作出必要的**简化假设**，运用适当的**数学工具**，得到的一个**数学结构**。

建立数学模型的全过程：包括表述、求解、解释、检验等

数学建模的具体应用：分析与设计、预报与决策、控制与优化、规划与管理

### 1.2 初等数学模型示例

#### 椅子的例子

例2 椅子能在不平的地面上放稳吗？

【问题分析】通常 : 三只脚着地；**放稳 : 四只脚着地**

模型假设：

* 四条腿一样长，椅脚与地面是点接触，四脚连线呈正方形；
* 地面高度连续变化，可视为数学上的连续曲面；
* 地面相对平坦，使椅子在任意位置至少三只脚同时着地。

#### 模型构成

用数学语言把椅子位置和四只脚着地的关系表示出来

椅子位置：利用正方形(椅脚连线)的对称性，用 $\theta$ (对角线与x轴的夹角)表示椅子位置

四只脚着地：椅脚与地面距离为零，距离是 $\theta$ 的函数

* A，C 两脚与地面距离之和：$f(\theta)$
* B，D 两脚与地面距离之和：$g(\theta)$

![微信截图_20220114192301](数学建模 笔记.assets/微信截图_20220114192301.png)

地面为连续曲面 $\Longrightarrow$  $f(\theta),g(\theta)$ 是连续函数

椅子在任意位置至少三只脚着地 $\Longrightarrow$  对任意 $\theta$ ，$f(\theta),g(\theta)$ 至少一个为0

转换为数学问题：已知：$f(\theta),g(\theta)$ 是连续函数 ；对任意 $\theta$ ，$f(\theta)\cdot g(\theta)=0$；且 $g(0)=0$， $f(0) > 0$。证明：存在 $\theta_0$ ，使 $f(\theta_0) = g(\theta_0) = 0$ 。

#### 模型求解

一种简单、粗糙的证明方法

将椅子旋转 $90^\circ$ ，对角线AC和BD互换。

由g(0)=0， f(0) > 0 ，知 $f(\pi/2)=0,g(\pi/2)>0$ 。

令 $h(\theta)= f(\theta)–g(\theta)$ ，则 $h(0)>0$ 和 $h(\pi/2)<0$ 。

由 f, g的连续性知 h为连续函数, 据连续函数的基本性质, 必存在 $\theta_0$ , 使 $h(\theta)0)=0$ , 即 $f(\theta_0) = g(\theta_0)$ 。

因为 $f(\theta)\cdot g(\theta)=0$ , 所以 $f(\theta_0) = g(\theta_0)=0$

### 1.3 数学建模的基本方法

* 机理分析：根据对客观事物特性的认识，找出反映内部机理的数量规律。
* 测试分析：将对象看作“黑箱”，通过对量测数据的统计分析，找出与数据拟合最好的模型。
* 二者结合：用机理分析建立模型结构，用测试分析确定模型参数。
* 机理分析没有统一的方法，主要通过实例研究(Case Studies)来学习。以下建模主要指机理分析。

一般步骤：

1. 模型求解：各种数学方法、软件和计算机技术
2. 模型分析：如结果的误差分析、统计分析、模型对数据的稳定性分析
3. 模型检验：与实际现象、数据比较，检验模型的合理性、适用性
4. 模型应用

## 第三章 简单的优化模型

* 现实世界中普遍存在着**优化问题**
* 静态优化问题指**最优解是数**(不是函数)
* 建立静态优化模型的关键之一是根据建模目的确定恰当的**目标函数**
* 求解静态优化模型一般用**微分法**

### 3.1 存贮模型

### 不允许缺货的存贮模型

#### 问题定义

配件厂为装配线生产若干种产品，轮换产品时因更换设备要付生产准备费，产量大于需求时要付贮存费. 该厂生产能力非常大，即所需数量可在很短时间内产出.

具体例子：已知某产品日需求量100件，生产准备费5000元，贮存费每日每件1元. 试安排该产品的生产计划，即多少天生产一次（生产周期），每次产量多少，使总费用最小。

#### 模型假设

1. 产品每天的需求量为常数 $r$；
2. 每次生产准备费为 $c_1$，每天每件产品贮存费为 $c_2$；
3. $T$ 天生产一次（周期），每次生产 $Q$ 件，当贮存量为零时，$Q$ 件产品立即到来（生产时间不计）；
4. 为方便起见，时间和产量都作为连续量处理

建模目的：设 $r,c_1,c_2$ 已知，求 $T,Q$ 使每天总费用的平均值最小。

#### 模型建立

贮存量表示为时间的函数 $q(t)$，$t=0$ 生产Q件，$q(0)=Q$， $q(t)$ 以需求速率 $r$ 递减，$q(T)=0$ 。

一周期贮存费为：
$$
c_2 \int_0^T q(t)dt=c_2 \frac{QT}{2}
$$
一周期总费用：
$$
\tilde{C}=c_1+c_2\frac{QT}{2}=c_1+c_2\frac{rT^2}{2}
$$
每天总费用平均值（目标函数）：
$$
C(T)=\frac{\tilde{C}}{T}=\frac{c_1}{T}+\frac{c_2rT}{2}
$$

#### 模型求解

求T使得C（T）取min

由 $\cfrac{dC}{dT}=0$ ，解得：
$$
T=\sqrt{\frac{2c_1}{rc_2}}\\
Q=rT=\sqrt{\frac{2c_1r}{c_2}}
$$
此即经济批量订货公式（EOQ公式）

### 允许缺货的存贮模型

当贮存量降到零时仍有需求 $r$，出现缺货，造成损失。

* 原模型假设：贮存量降到零时，Q件立即生产出来(或立即到货)
* 现假设：允许缺货， 每天每件缺货损失费 $c_3$ ， 缺货需补足

#### 模型建立

设周期T， t=T1贮存量降到零，则：

一周期贮存费：
$$
c_2\int_0^{T_1}q(t)dt=c_2A
$$
一周期缺货费：
$$
c_3\int_{T_1}^{T}|q(t)|dt=c_3B
$$
一周期总费用：
$$
\bar{C}=c_1+c_2\frac{QT_1}{2}+c_3\frac{r(T-T_1)^2}{2}
$$
每天总费用平均值（目标函数）：

（代入 $Q=rT_1$ ，即 $T_1=\cfrac{Q}{r}$）
$$
C(T,Q)=\frac{\bar{C}}{T}=
\frac{c_1}{T}+\frac{c_2Q^2}{2rT}+
\frac{c_3(rT-Q)^2}{2rT}
$$

#### 模型求解

求T，Q使得C（T，Q）为min。

即令 $\cfrac{\partial C}{\partial T}=0,\ \cfrac{\partial C}{\partial Q}=0$ 。

解得：
$$
T'=\sqrt{\frac{2c_1}{rc_2}\frac{c_2+c_3}{c_3}}\\
Q'=\sqrt{\frac{2c_1r}{c_2}\frac{c_3}{c_2+c_3}}\\
$$

## 第四章 数学规划模型

### 数学规划

实际问题中的优化模型：min（或max）$z=f(x),\ x=(x_1,...,x_n)^T$

$s.t.\ g_i(x)\leq 0,\ i=1,2,...,m$

其中，$x$ 为决策变量，$f(x)$ 目标函数，$g_i(x)\leq 0$ 约束条件

数学规划分为：线性规划、非线性规划、整数规划

* 重点在模型的建立和结果的分析

### 4.1 奶制品的生产与销售

#### 问题描述

![image-20220112175715487](数学建模 笔记.assets/image-20220112175715487.png)

几个额外问题：

* 35元可买到1桶牛奶，买吗？若买，每天最多买多少？
* 可聘用临时工人，付出的工资最多是每小时几元？
* A1的获利增加到 30元/kg，应否改变生产计划？

#### 模型建立

|          | 方式一                 | 方式二                 |
| -------- | ---------------------- | ---------------------- |
| 决策变量 | $x_1$ 桶牛奶生产 $A_1$ | $x_2$ 桶牛奶生产 $A_2$ |
| 目标函数 | 获利 $24\times 3x_1$   | 获利 $16\times 4x_2$   |
| 约束条件 |                        |                        |

每天获利 $max\ z=72x_1+64x_2$

约束条件：原料供应、劳动时间、加工能力、非负约束（1-4行）
$$
x_1+x_2\leq 50\\
12x_1+8x_2\leq 480\\
3x_1\leq 100\\
x_1,x_2\geq 0
$$

#### 模型求解

可用图解法，在 $B(20,30)$ 点得到最优解

### 总结

* 由于产品利润、加工时间等均为常数，可建立**线性规划**模型
* 线性规划模型的三要素：==**决策变量、目标函数、约束条件**==
* 建模时尽可能利用原始的数据信息，把尽量多的计算留给计算机去做（分析例2的建模）
* 用LINGO求解，输出丰富，利用**影子价格**和**灵敏性分析**可对结果做进一步研究
* 最优解一定在==凸多边形的某个顶点==取得

## 第五章 微分方程模型

### 5.6 人口的预测和控制

#### 指数增长模型

基本假设 : 人口(相对)增长率 r 是常数。

* x(t)指时刻t的人口

$$
\frac{dx}{dt}=rx,\ x(0)=x_0
$$

解得：
$$
x(t)=x_0(e^r)^t\approx x_0(1+r)^t
$$
随着时间增加，人口按指数规律无限增长。（与事实不符）

#### 阻滞增长模型(Logistic模型)

人口增长到一定数量后，增长率下降的原因：资源、环境等因素对人口增长的阻滞作用。且阻滞作用随人口数量增加而变大。假设：
$$
r(x)=r-sx=r(1-\frac{x}{x_m})
$$

* $r$ 固有增长率（x很小时）
* $x_m$ 人口容量（资源、环境能容纳的最大数量）

因而：
$$
\frac{dx}{dt}=rx=rx(1-\frac{x}{x_m})
$$
解得：
$$
x(t)=\cfrac{x_m}{1+(\cfrac{x_m}{x_0}-1)e^{-rt}}
$$

### 5.1 传染病模型

#### SI模型

思想：区分已感染者(病人)和未感染者(健康人)

假设：

1. 总人数N不变，病人和健康人的比例分别为 $i(t),s(t)$
2. 每个病人每天有效接触人数比例为 $\lambda$，且使接触的健康人致病

$$
\frac{di}{dt}=\lambda si=\lambda i(1-i)\\
i(0)=i_0
$$

与Logistic模型类似

#### SIS模型

传染病无免疫性——病人治愈成为健康人，健康人可再次被感染

增加假设：

3. 病人每天治愈的比例为 $\mu$ （指日治愈率）

$$
\begin{aligned}
\frac{di}{dt}&=\lambda si-\mu i\\
&=\lambda i[(1-\frac{1}{\sigma})-i]
\end{aligned}
$$

* 此处设 $\sigma=\lambda/\mu$ 。指一个感染期内每个病人的有效接触人数（比例），称为接触数（比例）

#### SIR模型

传染病有免疫性——病人治愈后即移出感染系统，称**移出者**。

* 总人数N，时刻t时，易感染者$s(t)$、感染者$i(t)$、移除者$r(t)$关系为：

$$
s(t)+i(t)+r(t)=1
$$

* 感染率 $\lambda$、治愈率 $\mu$、感染数 $\sigma = \lambda/\mu$ 。微分方程形式为：

$$
\begin{align}
\frac{di}{dt} &= \lambda si-\mu i	\\
\frac{ds}{dt} &= -\lambda si	\\
\frac{dr}{dt} &= \mu i	\\
\end{align}
$$

#### 相轨线分析

$$
i(0)=i_0,\ s(0)=s_0,\ r(0)=r_0
$$

通常 $r(0)=r_0$ 很小，因此可认为 $i_0+s_0\approx1$ 。因此，原SIR微分方程近似为：
$$
\begin{align}
\frac{di}{dt} &= \lambda si-\mu i	\\
\frac{ds}{dt} &= -\lambda si	\\
i(0)&=i_0,\ s(0)=s_0
\end{align}
$$
代入 $\sigma=\lambda/\mu$ 并消去dt：
$$
\frac{di}{ds}=\frac{1}{\sigma s}-1\\
i|_{s=s_0}=i_0
$$
两边积分：
$$
\begin{align}
\int di&=\int(\frac{1}{\sigma s}-1)ds\\
i&=\frac{1}{\sigma}\ln s-s+C
\end{align}
$$
代入 $i(s_0)=i_0$ ，可解得：
$$
C=i_0+s_0-\frac{1}{\sigma}\ln s_0
$$
因此，相轨线：
$$
i(s)=(s_0+i_0)-s+\frac{1}{\sigma}\ln\frac{s}{s_0}
$$

#### 阈值条件

![image-20220113094036350](数学建模 笔记.assets/image-20220113094036350.png)

分两种情况讨论：

* 当 $s_0>1/\sigma$ 时，$i(t)$ 先升后降至0，传染病蔓延；
* 当 $s_0<1/\sigma$ 时，$i(t)$ 单调降至0，传染病不蔓延；

预防传染病蔓延的手段：

* 提高阈值 $1/\sigma = \mu/\lambda$ ：
  * $\lambda\downarrow$ ：日接触率降低，**卫生（防御）水平提高**；
  * $\mu\uparrow$ ：日治愈率提高，**医疗水平提高**；

* 降低 $s_0$ ：通过提高 $r_0$，如**群体免疫**

以最终未感染比例 $s_{\infty}$ 和病人比例最大值 $i_m$ 为度量指标

#### $\sigma$ 的估计

在以下式子基础上，忽略 $i_0$ ：
$$
s_0+i_0-s_{\infty}+\frac{1}{\sigma}\ln\frac{s_{\infty}}{s_0}=0 \tag{1}
$$
得到：
$$
\sigma=\frac{\ln s_0-\ln s_{\infty}}{s_0-s_{\infty}}
$$

#### 被传染人数估计

记被传染人数比例 $x=s_0-s_{\infty}$ 。设 $i_0\cong 0, s_0\cong 1$ 及公式（1）。可推出：
$$
x+\frac{1}{\sigma}\ln(1-\frac{x}{s_0})\approx 0
$$
再假设 $x<<s_0$ ：
$$
\begin{aligned}
x(1-&\frac{1}{s_0\sigma}-\frac{x}{2s_0^2\sigma})\approx 0\\
\implies x&\approx 2s_0\sigma(s_0-\frac{1}{\sigma})\\
&\approx 2\delta
\end{aligned}
$$
最后一步设 $s_0-\cfrac{1}{\sigma}=\delta$ ，以及 $\delta$ 小，$s_0\delta\approx 1$

结论：提高阈值 $1/\sigma$ ，以降低被传染人数比例 $x$

### 5.3 正规战与游击战

#### 一般战争模型

用 $x(t)$ 和 $y(t)$ 表示甲乙交战双方时刻t的兵力，不妨视为双方的士兵人数。假设:

1. 每一方的战斗减员率取决于双方的兵力和战斗力，甲乙方的战斗减员率分别用 $f(x,y)$ 和 $g(x,y)$ 表示.
2. 每一方的非战斗减员率(由疾病、逃跑等因素引起)只与本方的兵力成正比。
3. 甲乙双方的增援率是给定的函数，分别用 $u(t)$ 和 $v(t)$ 表示。

$$
\begin{cases}
\dot x(t) = -f(x,y) - \alpha x+u(t), & \text{$\alpha>0$} \\
\dot y(t)=-g(x,y)-\beta x+v(t), & \text{$\beta>0$}
\end{cases}
$$

$f,g$ 取决于战争类型

#### 正规战争模型

##### 初始模型

甲方战斗减员率只取决于乙方的兵力和战斗力

* 乙方战斗有效系数a， $f(x,y)=-ay$ ，a为乙方每个士兵的杀伤率。甲方战斗有效系数b
* 其中 $a=r_yp_y$ ，$r_y$ 为（乙方）射击率，$p_y$ 为命中率

$$
\begin{cases}
\dot x(t) = -ay - \alpha x+u(t) \\
\dot y(t)=-bx-\beta x+v(t)
\end{cases}
$$

* 分析战争结局时，忽略非战斗减员 $\alpha,\beta$ ，假设双方均无增援，初始兵力 $x_0,y_0$ 。模型变为：

$$
\begin{cases}
\dot x(t) = -ay \\
\dot y(t)=-bx	\\
x(0)=x_0,\ y(0)=y_0
\end{cases}
$$

##### 战争结局

为判断战争的结局，不求 $x(t),y(t)$ 而在相平面上讨论 x 与 y 的关系：
$$
\frac{dy}{dx}=\frac{bx}{ay}
$$
再两边积分，推出：
$$
ay^2-bx^2=k\\
k=ay_0^2-bx_0^2
$$

* 甲方胜利：$k<0$ ，此时当 $y=0$ 时 $x>0$ ；
* 乙方胜利：$k>0$ ，此时当 $x=0$ 时 $y>0$ ；
* 平局：$k=0$

##### 平方律模型

$k>0$ 的条件为：
$$
(\frac{y_0}{x_0})^2>\frac{b}{a}=\frac{r_xp_x}{r_yp_y}
$$
初始兵力之比以平方关系影响战争结局，故称为“平方律模型”

#### 游击战争模型

双方都用游击部队作战。甲方士兵在乙方士兵看不到的某个面积为s，的隐蔽区域内活动，乙方士兵不是向甲方士兵开火，而是向这个隐蔽区域射击，并且不知道杀伤情况。这时甲方战斗减员率不仅与乙方兵力有关，而且随着甲方兵力的增加而增加。因为在一个有限区域内，士兵越多，被杀伤的就越多。这样可以简单地假设 $f(x,y)=-cxy$。

模型写作：
$$
\begin{cases}
\dot x(t) = -cxy \\
\dot y(t)=-dxy	\\
x(0)=x_0,\ y(0)=y_0
\end{cases}
$$

##### 战争结局

同样方法推导：
$$
\frac{dy}{dx}=\frac{d}{c}
$$
再两边积分，推出：
$$
cy-dx=m\\
m=cy_0-dx_0
$$

* 甲方胜利：$m<0$ ，此时当 $y=0$ 时 $x>0$ ；
* 乙方胜利：$m>0$ ，此时当 $x=0$ 时 $y>0$ ；
* 平局：$m=0$

##### 线性律模型

$$
\frac{y_0}{x_0}>\frac{d}{c}=\frac{r_xs_{rx}s_x}{r_ys_{ry}s_y}
$$

线性关系

#### 混合战争模型

条件假设：甲方为游击部队，乙方为正规部队

模型写作：
$$
\begin{cases}
\dot x= -cxy \\
\dot y=-bx	\\
x(0)=x_0,\ y(0)=y_0
\end{cases}
$$

##### 战争结局

同样方法推导：
$$
\frac{dy}{dx}=\frac{b}{cy}
$$
再两边积分，推出：
$$
cy^2-2bx=n\\
n=cy_0^2-2bx_0
$$

* 甲方胜利：$n<0$ ，此时当 $y=0$ 时 $x>0$ ；
* 乙方胜利：$n>0$ ，此时当 $x=0$ 时 $y>0$ ；
* 平局：$n=0$

乙方胜利条件 $n>0$ 时：
$$
(\frac{y_0}{x_0})^2>\frac{2b}{cx_0}
=\frac{2r_xp_xs_x}{r_ys_{ry}s_0}
$$

### 5.9 三级火箭发射（补充）

#### 牛顿第二定理

例题：设小型火箭初始质量为 $m_0$ 千克，其中包含 $m_1$ 千克燃料，即：$m_0=m_1+m_s$ ，$m_s$ 是火箭外壳等结构质量。火箭从地面垂直向上发射时，燃料以r kg/s的速率燃烧，对火箭产生F牛顿的恒定推力，燃料燃尽后火箭继续上升，直到达到最高点。

因为火箭上升高度与地球半径相比很小，所以可以认为整个过程受到的地球引力不变，重力加速度不变，忽略空气阻力，基于牛顿第二定理建立火箭升空过程的数学模型。

设燃料燃尽的时间为 $t_1$ ，有 $t_1=m_1/r$ 。火箭到达最高点的时间记为 $t_2$ ，由 $v(t_2)=0$ 确定。
$$
\begin{cases}
(m_0-rt)a=F-(m_0-rt)g, &t<t_1时\\
(m_0-m_1)a=-(m_0-m_1)g, &t_1<t\leq t_2时
\end{cases}
$$
以下部分自推导：

设1阶段结束时速度 $v_1$ 
$$
\begin{aligned}
v_1&=\sum_0^{t_1}a_1\cdot \Delta t\\
&=\int_0^{t_1}(\frac{F}{m_0-rt}-g)\Delta t\\
&=[-\frac{F}{r}\cdot \ln(\frac{m_0}{r}-t)-gt]_0^{t_1}\\
&=-\frac{F}{r}\cdot \ln(\frac{m_0}{r}-t_1)-gt_1+\frac{F}{r}\cdot \ln(\frac{m_0}{r})
\end{aligned}
$$
代入具体数值可算出答案。

### 7.2 军备竞赛模型

描述双方(国家或国家集团)军备竞赛过程，解释(预测)双方军备竞赛的结局。

假设：

1. 由于相互不信任，一方军备越大，另一方军备增加越快；
2. 由于经济实力限制，一方军备越大，对自己军备增长的制约越大；
3. 由于相互敌视或领土争端，每一方都存在增加军备的潜力

进一步假设：1、2作用为线性，3的作用为常数

#### 模型建立

$$
\dot x(t)=-\alpha x+ky+g\\
\dot y(t)=-\beta y+lx+h
$$

解释说明：

* $x(t)$ 为甲方军备数量，$y(t)$ 为乙方军备数量；
* $\alpha,\beta$ 本方经济实力的制约；
* $k,l$ 对方军备数量的刺激；
* $g,h$ 本方军备竞赛的潜力

军备竞赛的结局为：当 $t\rightarrow\infty$ 时的 $x(t),y(t)$

关注微分方程的平衡点及稳定性

#### 平衡点与稳定性

**平衡点** $P_0(x_0,y_0)$ 为代数方程 $ax+by=0,\ cx+dy=0$ 的根。

稳定平衡点：若从 $P_0$ 某邻域任一初值出发，都有【以下条件】，称P0是微分方程的**稳定平衡点**
$$
\lim_{t\to\infty}x(t)=x_0,\ \lim_{t\to\infty}y(t)=y_0
$$
记系数矩阵：
$$
A=
\begin{bmatrix}
a & b\\
c & d
\end{bmatrix}
$$
特征方程：
$$
det(A-\lambda I)=0
$$
特征根：
$$
\lambda_{1,2}=(-p\pm \sqrt{p^2-4q})/2
$$
其中，p，q取值为：
$$
\begin{cases}
\lambda^2+p\lambda+q=0\\
p=-(a+d)\\
q=det\ A
\end{cases}
$$
结论：

* $\lambda_{1,2}$ 为负数或有负实部 $\iff$ $p>0$ 且 $q>0$ $\iff$ 平衡点 $P_0=(0,0)$ 稳定
* $p>0$ 且 $q>0$ $\iff$ 平衡点 $P_0=(0,0)$ 不稳定

#### 军备竞赛模型分析

**平衡点**为：
$$
x_0=\frac{kh+\beta g}{\alpha\beta-kl},\ y_0=\frac{lg+\alpha h}{\alpha\beta-kl}
$$
系数矩阵：
$$
A=
\begin{bmatrix}
-\alpha & k\\
l & -\beta
\end{bmatrix}
$$
p与q取值分别为：
$$
p=-(-\alpha-\beta)=\alpha+\beta>0\\
q=det\ A=\alpha\beta-kl
$$
**平衡点 $(x_0,y_0)$ 稳定的条件**， $p>0,q>0$ ：
$$
\alpha\beta>kl
$$
结论：

1. 双方经济制约大于双方军备刺激时，军备竞赛才会稳定，否则军备将无限扩张。
2. 若 $g=h=0$， 则 $x_0=y_0=0$ ， 在 $\alpha\beta>kl$ 下 $x(t), y(t)\to0$，即友好邻国通过裁军可达到永久和平。
3. 若 g,h 不为零，即便双方一时和解，使某时 $x(t), y(t)$ 很小，但因 $\dot x>0,\dot y>0$，也会重整军备
4. 即使某时一方(由于战败或协议)军备大减， 如 $x(t)=0$，也会因 $\dot x=ky+g$ 使该方重整军备，
   即存在互不信任（ $k\neq 0$ ）或固有争端（ $g\neq 0$ ）的单方面裁军不会持久

## 第六章 差分方程模型

### 6.4 市场经济中的蛛网模型

观察到现象：商品数量与价格在振荡：

本模型用于：描述商品数量与价格的变化规律、研究震荡什么条件下趋于稳定、不稳定时政府采取什么干预手段

#### 基础模型

* $x_k$ 为第k时段商品数量，$y_k$ 为第k时段商品价格，$x_0,y_0$为平衡点。

* $\alpha$：商品数量减少1单位， 价格上涨幅度。表示消费者对需求的敏感程度
* $\beta$：价格上涨1单位， (下时段)供应的增量。表示生产者对价格的敏感程度

$$
\begin{cases}
y_k-y_0 = -\alpha(x_k-x_0)\\
x_{k+1}-x_0 = \beta(y_k-y_0)
\end{cases}
$$

代入，消去q相关变量：
$$
x_{k+1}-x_0=-\alpha\beta(x_k-x_0)
$$
递推地解出：
$$
x_{k+1}-x_0=(-\alpha\beta)^k(x_1-x_0)
$$

* 因此，仅当系数满足 $\alpha\beta<1$ 时，才有 $x_k\to x_0(k\to \infty)$ ，且 $y_k\to y_0$ 。平衡值是稳定的。
* 若 $\alpha\beta>1$ 时， $x_k,y_k\to\infty(k\to\infty)$ 。平衡值不稳定

#### 推广模型

认为生产者管理水平提高， 生产者根据当前时段和前一时段的价格决定下一时段的产量。此时的供应函数变化，需求函数不变：
$$
\begin{cases}
y_k-y_0 = -\alpha(x_k-x_0)\\
x_{k+1}-x_0 = \beta(\cfrac{y_k+y_{k-1}}{2}-y_0)
\end{cases}
$$
此时为二阶线性常系数差分方程：
$$
2x_{k+2}+\alpha\beta x_{k+1}+\alpha\beta x_k=2(1+\alpha\beta)x_0
$$
方程通解 $x_k=c_1\lambda_1^k+c_2\lambda_2^k$ ，$\lambda_{1,2}$ 为特征根，即方程 $2\lambda^2+\alpha\beta\lambda+\alpha\beta=0 $ 的两个根

**平衡点稳定**的条件为：
$$
|\lambda_{1,2}|<1
$$
方程的两个解即为特征根：
$$
\lambda_{1,2}=\frac{-\alpha\beta\pm\sqrt{(\alpha\beta)^2-8\cdot \alpha\beta}}{4}
$$
根据 $\alpha\beta$ 与8的大小分2情况讨论：

<i> 当 $\alpha\beta>8$ 时，方程有2个实根
$$
\lambda_2=\frac{-\alpha\beta-\sqrt{(\alpha\beta)^2-8\alpha\beta}}{4}
<-\frac{\alpha\beta}{4}
$$
因此 $|\lambda_2|>2$，P0不是平衡点

<ii> 当 $\alpha\beta<8$ 时，方程有2个共轭复根，计算其与原点的模长
$$
\begin{aligned}
|\lambda_{1,2}|&=\sqrt{(\frac{\alpha\beta}{4})^2+
(\frac{\sqrt{8\alpha\beta-(\alpha\beta)^2}}{4})^2}\\
&=\frac{1}{4}\sqrt{(\alpha\beta)^2+8\alpha\beta-(\alpha\beta)^2}\\
&=\sqrt{\frac{\alpha\beta}{2}}
\end{aligned}
$$
此时，平衡条件放宽到 $\alpha\beta<2$ ，比之前宽松。

## 第八章 离散模型

### 8.1 层次分析模型

#### 背景

* 日常工作、生活中的决策问题
* 涉及经济、社会等方面的因素
* 作比较判断时人的主观选择起相当大的作用，各因素的重要性难以量化

* Saaty于20世纪70年代提出层次分析法**AHP** (Analytic Hierarchy Process)
* AHP——一种**定性与定量相结合的、系统化、层次化**的分析方法

#### 思维过程

例：选择旅游地。如何在3个目的地中按照景色、费用、居住条件等因素选择？

![image-20220113154338735](数学建模 笔记.assets/image-20220113154338735.png)

* 将决策问题分为3个**层次**：目标层O，准则层C，方案层P；每层有若干元素， 各层元素间的关系用相连的直线表示
* 通过**相互比较**确定各准则对目标的**权重**，及各方案对每一准则的权重
* 将上述两组权重进行**综合**，确定各方案对目标的权重
* 层次分析法将**定性分析与定量分析**结合起来完成以上步骤，给出决策问题的定量结果

#### 基本步骤

##### 成对比较阵

元素之间两两对比，对比采用相对尺度

设要比较各准则 $C_1,C_2,\ldots,C_n$ 对目标O的重要性
$$
C_i:C_j\Rightarrow a_{ij},\ A=(a_{ij})_{n\times n},\ a_{ij}>0,\ a_{ji}=\frac{1}{a_{ij}}
$$
A为**成对比较阵**，是一个正互反阵：
$$
A=
\begin{bmatrix}
1 & 1/2 & 4 & 3 & 3\\
2 & 1 & 7 & 5 & 5\\
1/4 & 1/7 & 1 & 1/2 & 1/3\\
1/3 & 1/5 & 2 & 1 & 1\\
1/3 & 1/5 & 3 & 1 & 1
\end{bmatrix}
$$

* 要由A确定 $C_1,...,C_n$ 对O的权向量

##### 一致阵

如果一个正互反阵A满足
$$
a_{ij}\cdot a_{jk}=a_{ik},\ i,j,k=1,2...,n
$$
称之为**一致阵**。

具有如下性质：

* A的秩为1，A的唯一非零特征根为n
* A的任一列向量是对应于n 的特征向量
* A的归一化特征向量可作为权向量

令 $a_{ij}=w_i/w_j$ ，此时得到：
$$
\begin{bmatrix}
\cfrac{w_1}{w_1} & \cfrac{w_1}{w_2} & \ldots & \cfrac{w_1}{w_n}\\
\vdots & \vdots &  & \vdots\\
\cfrac{w_n}{w_1} & \cfrac{w_n}{w_2} & \ldots & \cfrac{w_n}{w_n}
\end{bmatrix}
$$
权向量w：
$$
w=(w_1,w_2,\ldots,w_n)^T
$$
允许不一致，但要确定不一致的允许范围。

对于不一致(但在允许范围内)的成对比较阵A，建议用对应于最大特征根 $\lambda$ 的特征向量作为权向量w，即：
$$
A\omega=\lambda\omega
$$

##### 一致性检验

衡量对A确定不一致的允许范围。

已知：n 阶一致阵的唯一非零特征根为n。

可证：n 阶正互反阵最大特征根 $\lambda\geq n$ ， 且 $\lambda=n$ 时为一致阵。

定义**一致性指标**
$$
CI=\frac{\lambda-n}{n-1}
$$

* CI 越大，不一致越严重

为衡量CI 的大小，引入**随机一致性指标 RI**——随机模拟得到 $a_{ij}$  ， 形成A，计算CI 即得RI

定义**一致性比率**：
$$
CR = CI/RI
$$

* 当CR<0.1时通过一致性检验

Saaty给出的RI结果如下（对于一个特定的n，查表得到RI）：

| n    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 10   | 11   |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| RI   | 0    | 0    | 0.58 | 0.90 | 1.12 | 1.24 | 1.32 | 1.41 | 1.45 | 1.49 | 1.51 |

##### 步骤总结

1. 建立层次分析结构模型

   深入分析实际问题，将有关因素自上而下分层（目标—准则或指标—方案或对象），上层受下层影响，而层内各因素基本上相对独立。

2. 构造成对比较阵

   用成对比较法和1~9尺度，构造各层对上一层每一因素的成对比较阵。

3. 计算权向量并作一致性检验

   对每一成对比较阵计算最大特征根和特征向量，作一致性检验，若通过，则特征向量为权向量。

4. 计算组合权向量（作组合一致性检验*）

   组合权向量可作为决策的定量依据。

#### 若干问题

##### 正互反阵最大特征根和特征向量的简化计算

* 精确计算复杂且不必要
* 简化计算的思路——一致阵的任一列向量都是特征向量，一致性尚好的正互反阵的列向量都应近似特征向量，可取其某种意义下的平均

![image-20220113165257322](数学建模 笔记.assets/image-20220113165257322.png)

##### 层次分析法的优点

3条优点：**系统性、实用性、简洁性**

* 系统性——将对象视作系统，按照分解、比较、判断、综合的思维方式进行决策——系统分析
  （与机理分析、测试分析并列）；
* 实用性——定性与定量相结合，能处理传统的优化方法不能解决的问题；
* 简洁性——计算简便，结果明确，便于决策者直接了解和掌握.

##### 层次分析法的局限

3点局限：**囿旧、粗略、主观**

* 囿旧——只能从原方案中选优，不能产生新方案；
* 粗略——定性化为定量，结果粗糙；
* 主观——主观因素作用大，结果可能难以服人

## 第十二章 马氏链模型

马氏链模型：描述一类重要的**随机动态**系统(过程)的模型。

特点：

* 系统在每个时期所处的状态是随机的
* 从一时期到下时期的状态按一定概率转移
* 下时期状态只取决于本时期状态和转移概率。**已知现在，将来与过去无关（无后效性）**

### 12.1 健康与疾病

保险公司要对投保人未来的健康状态作出估计， 以制订保险金和理赔金的数额

例1. 人的健康状况分为健康和疾病两种状态，设对特定年龄段的人，今年健康、明年保持健康状态的概率为0.8， 而今年患病、明年转为健康状态的概率为0.7.若某人投保时健康， 问10年后他仍处于健康状态的概率

#### 状态与状态转移

转移概率
$$
p_{ij}=P(X_{n+1}=j|X_n=j),i,j=1,2,n=0,1,...
$$
Xn+1只取决于Xn和pij， 与Xn-1， …无关.$n\rightarrow\infty$时状态概率趋于稳定值， 稳定值与初始状态无关.
$$
\begin{cases}
a_1(n+1)=a_1(n)p_{11}+a_2(n)p_{21}	\\
a_2(n+1)=a_1(n)p_{12}+a_2(n)p_{22}
\end{cases}
$$

#### 两个重要类型

##### 正则链

从任一状态出发经有限次转移能以正概率到达另外任一状态。

正则链 $\iff$ $\exist w,a(n)\to w(n\to\infty)$

**w为稳态概率**，满足：

1. $wP=w$
2. $\sum_{i=1}^k w_i=1$

例如以上题为例，
$$
P=
\begin{bmatrix}
0.8 & 0.2\\
0.7 & 0.3
\end{bmatrix},\ 
w=(7/9,2/9)
$$

##### 吸收链

吸收链 ~ 存在吸收状态（一旦到达就不会离开的状态$i$， $p_{ii}=1$），且从任一非吸收状态出发经有限次转移能以正概率到达吸收状态

### 12.2 钢琴销售的存贮策略

#### 问题描述

钢琴销售量很小，商店的库存量不大以免积压资金。一家商店根据经验估计，平均每周的钢琴需求为1架.
存贮策略：每周末检查库存量，仅当库存量为零时，才订购3架供下周销售；否则，不订购

估计在这种策略下失去销售机会的可能性有多大？以及每周的平均销售量是多少？

#### 模型建立

Dn~第n周需求量，均值为1的泊松分布：$P(D_n=k)=e^{-1}/k!$

| $D_n$ | 0     | 1     | 2     | 3     | >3    |
| ----- | ----- | ----- | ----- | ----- | ----- |
| $P$   | 0.368 | 0.368 | 0.184 | 0.061 | 0.019 |

设 $S_n$ 为第n周库存量（状态变量）$S_n\in\{1,2,3\}$

状态转移规律为：
$$
S_{n+1}=
\begin{cases}
S_n-D_n, &D_n<S_n\\
3, &D_n\geq S_n
\end{cases}
$$
$p_{ij}$ 指上一个状态 $i$ 库存、下一个状态 $j$ 库存概率，状态转移阵：
$$
P=
\begin{bmatrix}
p_{11} & p_{12} & p_{13}	\\
p_{21} & p_{22} & p_{23}	\\
p_{31} & p_{32} & p_{33}	
\end{bmatrix}
=
\begin{bmatrix}
0.368 & 0 & 0.632	\\
0.368 & 0.368 & 0.264	\\
0.368 & 0.368 & 0.448	
\end{bmatrix}
$$
求稳态概率分布 $w$ 满足 $wP=w$：
$$
w=(w_1,w_2,w_3)=(0.285,0.263,0.452)
$$

#### 模型求解

（存贮策略评估）

##### 估计失去销售机会的可能性

第n周失去销售机会的概率。n充分大时，$P(S_n=i)=w_i$
$$
\begin{align}
P(D_n>S_n) &= \sum_{i=1}^3P(D_n>i|S_n=i)P(S_n=i)	\\
&= P(D>1)w_1+P(D>2)w_2+P(D>3)w_3	\\
&= 0.264\times 0.285 + 0.080\times 0.2863 + 0.019\times 0.452	\\
&= 0.105
\end{align}
$$

##### 估计每周的平均销售量

第n周平均售量
$$
\begin{align}
R_n &= \sum_{i=1}^3[\sum_{j=1}^i jP(D_n=j|S_n=i)+iP(D_n>i|S_n=i)]P(S_n=i)	\\
&= 0.632\times0.285 + 0.896\times0.263 + 0.977\times0.452	\\
&= 0.857
\end{align}
$$

## 第十一章 博弈模型

### 11.1 进攻与撤退的抉择

#### 问题描述

* 博弈参与者为两方（盟军和德军）
* 盟军有3种使用其预备队的行动：强化缺口，原地待命，东进；德军有2种行动：向西进攻或向东撤退.
* 博弈双方**完全理性**，目的都是使战斗中己方获得的净胜场次（胜利场次减去失败场次）尽可能多
* **双方同时做出决策**，且具有**共同知识**

#### 博弈模型

* 盟军行动 $a_1\in A_1=\{1,2,3\}$(强化缺口/原地待命/东进)；
* 德军行动 $a_2\in A_2=\{1,2\}$(进攻/撤退)
* 用u1(a1，a2)表示对盟军产生的结果，即净胜场次，称为盟军的效用函数

**支付矩阵**：
$$
M=\{m_{ij}\}_{3\times 2}=
\begin{pmatrix}
1&0\\
2&0\\
-2&1
\end{pmatrix}
$$

#### 纳什均衡

* NE: 单向改变战略不能提高自己效用，即每一方的战略对于他方的战略而言都是最优的，称为**最优反应**

##### (纯战略)纳什均衡

$$
u_1(a_1^*,a_2^*) \geq u_1(a_1,a_2^*)\\
u_2(a_1^*,a_2^*) \geq u_2(a_1^*,a_2)
$$

##### 混合战略纳什均衡

* 双方随机采取行动，一方采取策略i的概率为$p_i$，另一方采取策略j的概率为$q_j$

盟军的混合战略集
$$
S_1=\{ p=(p_1,p_2,p_3)|0\leq p_i\leq 1 , \sum_{i=1}^3 p_i=1\}
$$
德军的混合战略集
$$
S_2=\{ q=(q_1,q_2)|0\leq q_i\leq 1 , \sum_{i=1}^2 q_i=1\}
$$
期望收益
$$
U_1(p,q)=pMq^T=\sum_{i=1}^3\sum_{j=1}^2 p_im_{ij}q_j\\
U_2(p,q)=-U_1(p,q)
$$

##### 模型求解

因此盟军目标为
$$
\mathop{max}\limits_{p\in S_1}\ pMq^T \tag{1}
$$
德军目标为
$$
\mathop{min}\limits_{q\in S_2}\ pMq^T \tag{2}
$$

* 盟军可以用 $min\ pM$ 来衡量策略p的好坏（具体方法：令向量中最小的向量最大，因为对手会调整策略使自己的收益减少）
* 德军可以用 $min\ Mq^T$ 来衡量策略q的好坏

书p372写作：
$$
(1)\Rightarrow \mathop{max}\limits_{p\in S_1}\ min\ pM\\
(2)\Rightarrow \mathop{min}\limits_{q\in S_2}\ max\ Mq^T
$$

#### 小结

博弈模型的基本要素：参与人、行动空间（及战略空间）、效用函数、行动顺序（静态、非静态）、信息结构（完全、不完全）

* 理性假设：参与者完全理性(最大化效用)

* 纳什均衡：单向改变战略不能提高自己效用

### 11.4 不患寡而患不均

#### 问题描述

最后通牒博弈(Ultimatum Game) 

甲乙两人就分配１笔钱（如100元）进行博弈。甲首先提出分配方案 (分给乙的钱: s)，如果乙接受，则按此分配 ，否则双方什么也得不到。

完全信息动态博弈：均衡结果是(s=0， 乙接受)； 如果要求严格均衡，则s=1分钱。（现实中并非如此）

#### 模型建立

假设：

1. 每个参与者都喜欢对所有参与者公平的结果；
2. 若某人所得比对方少，会因“愤怒”使效用降低；若某人所得比对方多，会因“愧疚”使效用降低

效用函数：
$$
U_i(x_1,x_2)=x_i-\alpha_imax\{x_j-x_i,0\}-\beta_imax\{x_i-x_j,0\}
$$

#### 模型求解

##### 乙的最优/理性反应

* 如果不接受，则 $x_1=x_2=0$ ； $U_1(s)=U_2(s)=0$

* 如果接受，则 $x_1=1-s, x_2=s$

  * 若 $s\geq 1/2$ ，则 $x_2\geq x_1$ 
    $$
    U_2(s)=s-\beta_2(2s-1)\geq 1/2\geq 0
    $$
    （此处用到 $\beta_2<1/2$）

  * 若 $s\leq 1/2$ ，则 $x_2\leq x_1$
    $$
    U_2(s)=s-\alpha_2(1-2s)=(1+2\alpha_2)s-\alpha_2
    $$
     此时，
    $$
    U_2(s)\geq 0\iff s\geq\bar{s}(\alpha_2)=\frac{\alpha_2}{1+2\alpha_2}
    $$

因此，乙的最优/理性反应为：当 $s\geq \bar{s}(\alpha_2)$ 接受； 否则，不接受。

##### 甲的决策

只需考虑乙接受情形。

情况1：甲知道乙的α2

均衡决策：
$$
s^*=\bar{s}(\alpha_2)=\frac{\alpha_2}{1+2\alpha_2}
$$


情况2：甲不知道乙的α2，但知道α2的分布F(α2)

决策：
$$
\mathop{max}\limits_
{\overline{s}(\underline{\alpha}) \leq \overline{s}(\overline{\alpha})}
[1-\beta_1+(2\beta_1-1)s]F(\frac{s}{1-2s})
$$

#### 模型解释

* 甲一般不会提出大于１/２的方案 $s$
* 乙拒绝过小的方案 $s$
* 乙接受概率随 $s$ 增加不减

很好地解释了实际中的最后通牒博弈。

## 第9讲 离散事件模型

### 离散事件仿真 (DES)简介

* 离散事件仿真主要研究对象是系统状态只在离散时间点上改变的系统
  * 一个前提是在连续状态转移之间没有相关事件发生
* 系统由实体(entities)及其相关属性( attributes)构成
* 系统状态由实体的一系列状态变量属性构成.
* 事件是时间点上瞬时发生的，它可以改变系统的状态

### DES的术语

* **事件**：随机发生、能改变系统状态（想象真实世界）
* **活动**：事件触发活动。每个活动意味着实体会在某个时间段上执行某些操作。
* **实体**：实体、属性、事件、活动以及他们之间的相互关系构成了离散事件系统的系统模型 。
* 系统环境：任何处于系统边界之外的、能对系统产生影响的对象与活动，所有这些构成了系统环境。
* 仿真时间：某个真实世界的、需要被仿真的时间段。
* **进程**：描述一个实体在其生命周期中经历的事件序列。（一个进程是一个事件序列，它可以包含多个活动）

![image-20220113205316990](数学建模 笔记.assets/image-20220113205316990.png)

### 如何推进仿真

每一个动态仿真模型的核心是时间推进机制。因此，每个模型包含一个称为内部时钟的变量，或又称作仿真时钟。

推进仿真时间的方法：==固定时间步长推进方法 (时间的同步模型)、下一事件推进方法 (时间的异步模型)==

#### 固定时间间隔推进

定义：所有实体的时钟以同样的步长 $\Delta t$ 更新

当所有实体按步长更新后，所有应该在步长内发生的事件就都清楚了。我们会假设事件都在步长的最后一刻发生，相应地，系统状态也在此时更新。

当系统事件发生在固定时间间隔时非常有用。

缺点：

* 无用的扫描 – 如果 $\Delta t$ 没有事件发生
* 准确度问题 –  $\Delta t$ 太大会损失精度 (事件只在  $\Delta t$ 的倍数时间上发生 )

#### 下一事件时间推进

* 推荐使用的方法
* 时间推进从当前时间到下一事件
* 仿真会跳过没有事件的阶段. 节省了计算机的运行时间，其代价是增加的编程难度
* 事件推进时，各模型异步执行，与时间步长推进的同步执行相反

##### 如何基于时间

* 维护一个事件列表来确定下一步发生什么。事件列表意味着不同类型事件所发生的时间。 (也叫做事件的日历，未来事件列表，事件日志等)
* 同时需要维护一个时钟变量来标记事件发生的时间。

##### 未来事件列表

一个事件日历 (也叫未来事件列表FEL，事件日记等)，包含所有将要调用的事件，并且以时序排列在仿真器中，FEL一般用链表或树实现。

##### 执行过程

* 时间/事件管理的基本方法- 执行过程 (也称作执行监控，调度器)
* 取出下一事件，推进仿真时间并且将控制权交给正确的执行过程 (事件，活动，进程)
* 执行过程的思路依赖于相应地建模视图(后面介绍).
* 不同建模视图的区别主要是下一事件选择的策略，以及不同类型的操作方法，比如事件、活动与进程。

下一事件时间推进算法的数据结构: 未来事件列表 (FEL)， 状态向量(SV)， 时钟(CL)

### 案例: 对单服务器排队系统的仿真

* 实体: 顾客， 服务台（服务器）
* **顾客属性**: 所需的服务
* 服务器属性: 能提供的服务、服务率
* **事件**: 顾客到达； 顾客离开
* 活动: 服务顾客，等待新的顾客

分类：

建模方面：顾客的到达、服务策略、中止规则

仿真方面：时间推进机制、事件类型、事件执行方法

**衡量指标：**平均逗留时间、队列中的平均顾客数、服务器利用率

### DES建模角度 (方法)

#### 建模视图

三种对世界建模视图：**进程交互方法、事件调度方法、活动扫描方法**

1. event scheduling（事件调度方法） -关注事件以及它们如何影响系统状态
2. process interaction（进程交互方法） - 关注实体以及它所经历的事件/活动序列
3. activity scanning（活动扫描方法） - 关注活动（每一活动对应开始时间和结束时间）；既使用调度时间也使用条件来选择事件列表中的下一事件

三种方法的核心都是**事件按时间顺序发生**（即按仿真时钟推进）。

### 离散事件仿真系统的组件要素与组织方法

#### 进程交互方法

* 一个进程要处理实体在系统中流动时发生的所有事件（包括确定事件和条件事件）。
* 每个实体可能在进程中的不同时间点上被阻塞或延迟。

##### 两类实体事件列表

进程交互法的调度执行包括两类时序的实体事件
列表:

1. 未来事件列表 **(FEL)** - 实体的进程被锁住，被锁实体的复活时间是已知的
2. 当前事件列表 **(CEL)** -
   * 实体进程被锁而复活时间等于当前仿真时钟值的实体；
   * 进程被锁且只有当某些条件满足时方能解锁的实体。

##### 调度函数执行

调度函数是这样执行的:

1. 将来事件表扫描：从FEL中拿出复活时间最小的实体，将时钟推进到下一事件发生时间
2. 移动记录：将FEL中在当前时刻复活的实体记录移至CEL中，把事件从FEL中移动到CEL中
3. 当前事件表扫描：将CEL中的实体进程从复活点开始向前推进，直到进程被锁住，扫描CEL看看是否有实体会在下一步执行

#### 活动扫描方法

* 使用固定时间间隔和基于规则的方法来决定是否开始一个活动(activity)
* 建模者关注模型的活动Aj及触发条件
* 在每一个时间步长，检查条件，如果条件为真，触发相应活动（实际上就是时间步长推进）
* 完全的活动扫描是费时费力的，程序效率低
* 通常与事件调度法相结合

##### 活动类别

* 三段扫描法
  * B 类活动描述确定事件
  * C 类活动描述条件事件
* B 类活动在 FEL中在某一时刻必定被执行
* 在每一次时间推进，检查是否有B类活动需要执行
* 然后检查C类活动并执行
* 重复此过程直到没有事件

【B类活动是某个时刻必定会执行的活动，不需扫描执行；C类活动是需要满足其他条件才能执行，才需要扫描执行。这样的话，就把B类、C类分开调用，提高程序执行效率。】

#### 事件调度方法

事件调度核心:
1. **把时钟推进到下一事件发生的时间**
2. **认为下一事件发生并执行它**

### DES仿真与模型构建的步骤

略？

### 小结

* 离散事件仿真
* 对于动态仿真
  * 需要时钟来对模型的推进进行仿真
  * 两种时间推进的方式
  * 三种建模方法（视图）
  * 离散事件仿真的代码示例

【以下为仿真部分】

## 第10章 物理仿真

### 10.1 概述

#### 仿真分类

仿真的分类：**数学仿真、数字计算机仿真、物理仿真、半实物仿真**

1. 数学仿真：对实际系统进行抽象，并将其特性用数学关系加以描述而得到系统的数学模型，对数学模型进行实验的过程称为数学仿真。
   * 优点：方便、灵活、经济
   * 缺点：受限于系统建模技术，即系统数学模型不易建立。
2. 数字计算机仿真：将系统数学模型用计算机程序加以实现，运行程序得到数学模型的解
3. 物理仿真：按照真实系统的物理性质构造系统的物理模型，并在物理模型上进行实验的过程称为物理仿真。
   * 优点：直观、形象，也称为“模拟”。
   * 缺点：缺点：模型改变困难，实验限制多，投资较大。
4. 半实物仿真：将数学模型与物理模型甚至实物联合起来进行实验。

当被仿真的系统中存在物理模型或实物时，必须进行实时仿真。**物理仿真和半实物仿真均为实时仿真**。

仿真的优点：

* 安全可靠，无破坏性/破坏性可控
* 经济效益好
* 缩短研制周期
* 可多次重复

#### 半实物仿真

##### 定义

定义：半实物仿真是指，在地面上、实验室内创造一定的条件，复现出飞行器在空间运动的环境和状态，再把实际的飞行控制器或主要元部件，如自动驾驶仪、增稳系统、导引头、平台、捷联惯导系统、陀螺等联接起来，构成仿真回路，进行动态实验研究。

半实物仿真也称**地面物理仿真**

##### 优点

* 实物直接参与仿真实验，可以避免难以准确建模的困难；
* 通过半实物仿真可以进一步校准系统的数学模型，可以检验飞行控制系统各设备的功能与性能。

##### 系统构成

半实物仿真系统一般包括仿真计算机、仿真设备、参试设备、各种接口设备、实验控制台和支持服务系统。

1. **仿真计算机**完成飞行器运动学和动力学方程的计算，将计算结果作为指令输出给仿真设备。
2. **仿真设备**按指令复现飞行器在空间运动的环境和状态。
3. **参试设备**即是待试验的飞行控制器或元部件，安装在仿真设备上，感知飞行器的各个状态参量并将测量结果通过接口送入仿真计算机。
4. **实验控制台**为操作者提供操作平台，完成仿真实验。
5. **支持服务系统**具有显示、记录、生成文件、打印等功能。
6. 接口设备将上述几部分连接成一个整体。

### 10.2 仿真设备及实验原理

#### 仿真设备

**仿真设备**也常被称为**模拟器**，是半实物仿真中使用数量和种类最多、也最重要的一类设备，在系统中用于模拟参试设备所处的真实环境中的某一种物理现象，其模拟或输出的信号是传感器可感知的各种物理现象和效应。

角运动模拟器即是**飞行仿真转台**，用来模拟飞行器在空间的三个**转动自由度**。
飞行器在空间运动的状态参量都是实际的物理量，如角度、角速度、角加速度，而计算机输出的各运动参量都是以模拟的电压量或数字量形式给出的。必须把这些**电的参量**转换成相应的物理量，才能被控制系统的各种敏感元件，如角位置陀螺、角速度陀螺等所测量感受。三轴飞行仿真转台即是飞行器姿态运动参量的模拟变换装置

#### 仿真实验原理

飞行器在空间的飞行运动是一个**六自由度**的运动体，包括三个自由度的姿态运动和三个自由度轨迹运动。

* **姿态运动**是飞行器在力矩作用下，相对于机体坐标系的三个偏转运动，分为偏航、滚转和俯仰三种运动。表征飞行器在力矩作用下在空间的姿态变化。
* **轨迹运动**是飞行器在外力作用下，相对固定坐标系质心的三个平移运动，分为上下（高度）、左右（侧向平移）和前进三个自由度。
* 飞行器为 “**被控对象**”，包括飞机、导弹、火箭、卫星等各种飞行器。

飞行器地面物理仿真系统有如下特点：

1. 系统中必须有飞行状态参数的模拟变换装置，本系统中由**飞行仿真转台**完成这一任务。
2. 系统中应当包含舵机、载荷等效应的模拟装置，本系统由舵机模拟器和气动载荷模拟装置实现这一功能。
3. 由于实物参与系统工作，所以模拟变换装置必须**实时**工作。

**模拟变换装置**的引入**不应影响**飞行控制系统本身的性能，即对变换装置本身必须有严格的技术要求，来满足仿真实验的需要。

在理想情况下，这一变换装置最好是一个**纯比例环节**。

### 10.3 飞行仿真转台

飞行仿真转台本身是一个复杂的机电控制系统，需要花费大量的人力、物力、财力进行研制。这个系统由机械部分和电控部分组成。

#### 转台结构原理

在确定飞行仿真转台三框坐标系时，应尽量满足上述关系特点（转动惯量、角速度的大小关系）。一般有**立式**和**卧式**两种结构形式。

##### 立式结构

立式结构的转台框架与飞行器机体坐标系的对应关系：

* 内框（X）------飞行器的滚转轴
* 中框（Z）------飞行器的俯仰轴
* 外框（Y）------飞行器的偏航轴

因而通过对三框的控制即可由内框复现飞行器在空间的角运动。

* **内框是负载框，参试设备应安装在内框。**

##### 卧式结构

* 内框----飞行器的滚转轴
* 中框----飞行器的偏航轴
* 外框----飞行器的俯仰轴

**内框仍是安装设备的负载框，通过对三框的控制即可由内框复现飞行器在空间的角运动。**

#### 转台基本功能

转台由**机械框架和伺服系统**两部分组成。

由**仿真计算机**给出的代表飞行器角运动参量的模拟电压量或数字量通过一套**伺服系统**控制转台**框架**运动，由此可见，转台实质上是一个电压量-机械量的变换器。

转台的功能要求：

1. 转台框架的机械运动量要能够准确复现计算机给出的相应电量。
2. 转台的内框（即负载框）应能方便地安装参试设备。
3. 转台框架的动、静态精度应能满足参试设备的精度要求。框架运动能够实现飞行器各种状态和各种运动功能的实验要求。

#### 转台功能与性能

型号研制与仿真**一体化设计**的思想，即在型号研制开始的时候就考虑仿真设备的性能要求等问题，从而使所提出的研制任务书更**合理**。

##### 机械结构

确定机械结构时要充分考虑参试设备的特性，如其重量、尺寸、安装形式等等。有些设备（如导引头）有**视场角**要求，则台体的框架不能阻挡其视线；有些设备安装时，要求其某个特殊点与转台的**回转中心**重合，或要求某个轴线与转台的内框（即负载框）**回转轴**重合；有些仿真实验要将多个设备安装在同一个转台上；有些实验要求框架能够连续旋转。

##### 性能及指标

转台的性能指标包括静态和动态两部分。

* **静态指标**主要有：
  位置精度 / 位置重复度 / 位置分辨率
  最大速度 / 最低平滑角速度 / 速度精度
* **动态指标**主要有：
  频率特性 / 最大角加速度 / 动态跟踪精度
* 近来由于捷联惯导系统的使用，对转台的性能指标又增加了跟踪速度信号的要求，所以还有一项**工作模式的指标**：位置状态 / 速度状态/加速度状态

速度状态的性能指标主要是动态指标，即**跟踪速度信号**时的通频带和动态跟踪精度。

##### 其他功能

频率特性指标：从控制理论可知，若转台的频带大于飞控系统的频带**5倍以上**，即可将转台视为一个比例环节。

例：某型飞行器的飞控系统频带为**1Hz**，转台的平坦段为**5Hz**。由于转台系统是复杂的高阶系统，故按平坦段的带宽要比通频带低5倍计算，则转台的频带为**25Hz**，比飞控系统的频带高20倍以上，在仿真实验时完全可以忽略转台系统的动态影响，将其视为纯比例环节。

##### 最大速度及最低平滑角速度的确定

* 转台各框的最大速度一定要**大于**飞行器对应轴的转动角速度，并要留有余地。
* 转台的最低平滑角速度标志着转台的速度灵敏度，该指标一定要**高于**参试的角速度敏感元件的灵敏度才能满足仿真实验的要求。

#### 转台的发展趋势

* 动态性能提高：加速度、频带、动态跟踪精度
* 精度性能提高：位置精度、速度精度
* 多用途：仿真、测试
* 多轴（自由度）转台：**五轴**、六轴、九轴
* 自动化程度提高
* 采用新技术：材料、元部件、控制理论与方法

#### 交会对接运动模拟器

略

### 10.4 仿真器

定义：**仿真器是一种以计算机为核心的声、光、机电系统。**

应用范围：飞行仿真器（航天器和航空器）、汽车仿真器、船舶仿真器、核电站仿真器

基本组成：环境模拟器与输出设备、人、指令接收设备、计算机系统及相关设备

#### 飞行仿真器

构成：主要由活动驾驶室及视景系统所组成，驾驶室中设有与真实飞机完全相同的仪表及操纵杆。

原理：主要通过飞行员（航天员）发出指令，通过计算机视景系统发生运动，实现声、光、机电系统发生联合动作，给人以一种真实感觉。

## 第11章 分布交互仿真与虚拟现实

### 11.1 分布交互仿真

定义：**DIS**（Distributed Interractive Simulation）是仿真应用系统之间进行交互作用的**虚拟环境**。

#### 特点

三个特点：==**分布、交互、实时性**==

* 分布：计算能力分布、地理位置分布
* 交互：各结点之间的信息交换、仿真系统的互操作性
* 实时：以同一时间基准，实时仿真

#### 分布交互仿真环境

功能：交互仿真功能、层次建模与仿真功能、实时并发仿真功能、信息支持功能、人机界面功能

设计原则：采用对象/事件结构、仿真结点具有自治性、保证信息传输的真实性、采用预估算法、采用协议转换、采用同一的地形几何表示

计算机网络：

* 广域网与局域网互连
* 支持综合业务传输：文字、声音、图像、数据
* 利用现有资源：异网互联、异机互联
* 广域网采用点对点交换方式
* 应保证实时性、安全性、保密性
* 采用光纤通讯技术

信息管理：

* 各结点的数据管理完全独立
* 能够实现数据共享
* 采用数据库方式管理结点数据及多节点共用数据
* 包含决策行为的结点应具有知识库
* 完成信息格式的转换和逆转换
* 尽量减少结点间的信息传输量

#### DIS的体系结构

1. 逻辑层次结构与物理网络互连结构相结合
2. 局部广播与点对点通讯相结合
3. 引入接口处理器

#### DIS的建模

特点：模型体系具有层次结构；各结点模型独立；各结点模型相关；模型多样。

建模要求：概念上一致、信息上相容

#### DIS分类

军事仿真按仿真逼真度分类：**真实仿真、虚拟仿真、结构仿真**

按应用角度分类：平台级分布式交互仿真、聚合级仿真协议ALSP、高级体系结构（HLA/RTI分布式交互仿真）

##### HLA/RTI体系

HLA/ RTI体系主要包括三部分：

1. **规则**。保证联邦中仿真应用间按正确的方式进行交互，描述各联邦成员的责任及它们与RTI的关系。提供了十条规则，分别对联邦和联邦成员作了规定。
2. **对象模型模板**。定义HLA对象模型信息的通用方法，提供一种标准格式的HLA对象模型模板，以促进模型的互操作性和资源的可重用性。
3. **接口规范说明**。定义联邦成员与联邦中其他成员进行信息交互的方式，即RTI的服务。其定义了RTI的六大管理功能。

##### RTI的逻辑结构

RTI由RTI全局执行进程RtiExec、联邦执行进程FedExec和LibRTI库组成。RtiExec是一个全局进程，**主要功能是管理联邦执行的创建和析构**，即FedExec进程的创建和析构，每个联邦成员通过与RtiExec通讯来进行初始化，加入到相应的联邦执行中。**FedExec管理一个与其一一对应的联邦仿真过程**，管理联邦成员的加入和退出，为联邦成员间的数据通讯和协调运行提供支持。**LibRTI是一个C++库，给联邦的开发者提供HLA接口规范**中定义的服务。

#### DIS的应用与展望

五个应用：**联合作战训练、武器系统评估、作战研究、作战模拟、武器系统采购**

DIS系统涉及面广，是一项浩大的过程。

* 首先是**仿真效果评估问题**。现在还未建立起对系统仿真效果进行科学评估的有关理论体系。
* 其次是大范围**仿真模型的建立**问题，包括飞机和地面车辆、天气系统、武器系统、雷达系统、红外系统、导航系统的建模以及声效和视觉模型的建立、地形地貌的建立与不断更新。
* 再次，**虚拟环境的显示效果**的真实化，需要作出大量努力。
* 最后**人机交互的硬件设备**也需要有所突破，以达到满意的交互效果。

### 11.2 虚拟现实

基本概念：VR是一种综合应用**计算机图形学、人机接口技术、传感器技术以及人工智能**等技术，**制造逼真的人工模拟环境**，并能有效地模拟人在自然环境中的各种感知的**高级的人机交互技术**。

#### 基本术语

提出：**1989年**，美国VPL Research公司创始人**Jaron Lanier**提出了“Virtual Reality”（虚拟现实）的概念。

如何理解“交互”：**包括感知环境并干预环境，从而产生置身于相应的真实环境中的虚幻感，沉浸感，身临其境的感觉。**

系统包括：人类**操作者**、人机**接口**和**计算机**

#### VR的要素

四个要素：**现代高科技手段、虚拟环境、输入输出设备、自然的交互**

VR技术特征：交互、沉浸、想象

另一版本：==多感知性、沉浸感、交互性、想象性==

#### VR的关键技术

四大技术：**计算机图形学、人机接口技术、传感器技术、人工智能**

#### VR的发展过程

* 第一阶段：萌芽态
* 第二阶段：虚拟现实技术从实验室走向系统化实现阶段
* 第三阶段：虚拟现实技术快速发展阶段
* 第四阶段：VR技术拓展---AR/MR技术（AR=增强现实、MR=混合现实/介导现实）

#### VR的应用领域

包括：飞行模拟器、教学、远程医疗、虚拟战场、其他

飞行模拟器是虚拟现实技术应用的先驱。通过模拟器训练飞行员是一条有效的途径，同时，飞行模拟器可以作为一种试验床，对飞机的操纵性、稳定性和机动性进行测试和评定，较容易分析飞机气动参数的修改对飞行品质的影响。

虚拟现实教学：可以用于教学、复杂手术过程的规划、在手术过程中提供操作和信息上的辅助、预测手术结果等。
虚拟战场：既通过建立虚拟战场环境来训练军事人员，同时又可以通过虚拟战场来检查和评估武器系统的性能。

#### 案例---虚拟装配机器人

略

## 第12章 并行仿真

### 引言

并行仿真的概念是相对于串行仿真和并行计算机发展的基础上提出的。

研究目的：

* 进一步提高仿真速度和精度；
* 满足大型动态系统的实时仿真需要。

为了利用并行计算求解一个计算问题，通常基于以下考虑：

1. **将计算任务分解成多个子任务，有助于同时解决；**
2. **在同一时间，由不同的执行部件可同时执行多个子任务；**
3. **多计算资源下解决问题的耗时要少于单个计算资源下的耗时。**

并行计算可分为：

1. **计算密集型**：如大型科学工程计算与数值模拟等；
2. **数据密集型**：如数字图书馆、数据仓库、数据挖掘和计算可视化等；
3. **网络密集型**：如协同计算和远程诊断等

定义：并行仿真(Parallel simulation)是依托于高性能的并行计算机的硬件架构和计算性能进行计算，其可以并行的对各式离散事件进行成规模的高效且高精度的计算仿真。

### 12.1 并行处理的一般概念

#### 串行仿真

串行仿真的仿真过程：建模 $\to$ 选择算法，选择步长 $\to$ 编程序计算

* 在前面例子的计算中，一个操作符只对应一组操作数，产生一个计算结果，这种方式称为**单指令流单数据流方式（SISD）**。
* 以SISD方式工作的计算机是串行计算机，进行的仿真是串行仿真。

#### 并行处理

并行处理的一般概念是指硬件设备的多倍重复，以处理机部件的多倍重复实现并行运算。

并行处理有两种含义：**同时性、并发性**

* 同时性：两个或两个以上事件在同一时刻发生。
* 并发性：两个或两个以上事件在同一时间间隔内发生。
* 第一种情况属于**并行计算**问题，第二种情况属于**串并行混合计算**问题。

#### 并行计算

并行计算，是指同时使用多种计算资源解决计算问题的过程。为执行并行计算，计算资源应包括一台配有多处理机（并行处理）的计算机、一个与网络相连的计算机专有编号，或者两者结合使用。

* 主要目的： 并行计算的主要目的是快速解决大型且复杂的计算问题。

* 优点 ：利用非本地资源，节约成本，使用多个“廉价”计算资源取代大型计算机，同时克服单个计算机上存在的存储器限制。

### 12.2 并行计算机的分类及结构

#### 按信息流传递形式分类

Single/Multi Instruction Single/Multi Data

* **SIMD计算机**：一个操作符作用于多组操作数，产生多个结果。
* **MIMD计算机**：多个操作符作用于多组操作数，产生多个结果。可进行并行处理，也可单独使用其中之一。
* **MISD计算机**：多个操作符作用于一组操作数，产生多个结果。

#### 按并行工作单元的层次等级分类

1. **关联并行处理机**：
   实现存储器操作的并行。
   关联存储器：按内容寻址，具有信息并行存储功能。
2. **流水线处理机**（向量机）：
   实现处理器的并行操作。将计算机的运算部件或控制单元装配成
   若干有序的子部件。
3. **并行处理机**：实现处理机的并行操作。
   不同的处理机完成不同的子任务。
4. **多计算机系统**：实现指令和任务的并行。
   可同时对多条指令及分别有关的数据进行处理，（MIMD）。
5. **分布式共享存储多处理机系统**（DSM）。
   每个并行单元有独立的操作系统，每个单元均可独立运行。

### 12.3 并行算法

#### 计算问题的分类

1. 串行计算问题：若一个问题的计算是按照SISD方式进行，即：每步计算都是一个操作符作用于一组操作数，产生一个结果，当前步计算依赖于前一步的结果，则称为串行计算问题。

2. 并行计算问题：若一个问题的计算是按照SIMD方式或MIMD方式进行，各分量之间无依赖，则称为并行计算问题。

   并行计算问题特征：
   （1）将工作分离成离散部分，有助于同时解决；
   （2）随时并及时地执行多个程序指令；
   （3）多计算资源下解决问题的耗时要少于单个计算资源下的耗时。

3. 串并行混合计算问题：若一个问题既有串行计算部分又有并行计算部分，则称为串并行混合计算问题。

#### 计算机算法的划分

按指令流与数据流的执行方式，计算机算法可分为三类：

1. 串行算法：SISD，串行计算机
2. 同步并行算法：SIMD，并行计算机
3. 异步并行算法：MIMD，并行计算机

#### 并行算法的计算树

计算树：表示求值过程的二叉树型图，双目操作。

例如，可将S=A+B*（C+DEF）+G的计算过程用计算树表示如下。

![image-20220114101448539](数学建模 笔记.assets/image-20220114101448539.png)

##### 部分术语

* 树叶：输入的n个数。
  节点：双目操作数的操作符。
  树枝：节点-节点间或树叶-节点间的连线。
  树根：计算结果。
  枝高度：树叶到树根间的枝数。
  树高：最大枝高度，即计算次数。

![image-20220114101633811](数学建模 笔记.assets/image-20220114101633811.png)

#### N个数求和的计算树

比较了使用2、4、8台处理机的树高

* 8台处理机：树高为4，但处理机利用效率较低，从第二步开始大部分处理机闲置。
* 4台处理机：树高为5，处理机利用效率较高。应采用有限并行度算法，以提高效率。
* 2台处理机：树高为8。处理机利用效率很高，但树高增加过多，计算时间延长，不是一个好方案。

总结：

* 计算N个数求和的并行算法是同步并行算法，每步的操作符相同，属于SIMD算法。
* 在确定处理机数量时，应综合考虑树高（即计算时间）与处理机利用效率，一般应采用有限并行度算法，兼顾计算时间与利用效率。

### 12.4 复杂系统的并行仿真

#### 并行仿真

讨论如何将并行处理技术应用到系统仿真中。
在多台处理机上对同一动态系统进行并行求解，达到减少仿真时间的目的。

#### 分割法并行仿真

基本思想：将一个系统分割成两个或两个以上的子系统，将每个子系统分配到一台处理机上进行计算。各处理机并行操作，并协调通讯，求得仿真结果。

仿真过程：

1. 将其分割为两个子系统：$Y=(Y_1,Y_2)T$
2. 采用2-RK算法
3. 时序：将Y1、Y2分别放在P1、P2处理机内计算
   1. 特点
      分割法在本质上是串行的，两个子系统的计算公式互相依赖。
      由于是通过任务分配实现并行仿真，故影响节省时间的因素主要有：
      
      耦合回路的数量、
      各子系统的方程数；
      、 
      通讯方式

#### 并行预报校正法

基本思想：得到一组能独立进行运算的迭代公式，以减少通讯量，提高计算速度和效率。

几个方法：并行Adams法（并行二阶预报校正法）、MPC法（并行四阶预报校正法）

并行预报校正法的特点：

1. 每计算一步只通讯一次。
2. （2）任务分配由算法本身决定，与系统模型无关。
3. （3）与同阶的串行预报校正法计算精度等价。
4. （4）稳定性比串行算法有所下降。

### 12.5 并行仿真典型应用

应用包括：分布式仿真、量子计算/仿真、基于GPU的并行仿真

## 第13章 MATLAB使用基础

### 13.1 MATLAB入门

#### 基本特点

1、开放性：可以很方便地扩展工具箱，增加功能函数。
2、语言： 易懂易记，语法简单；使用自然的数学语言解决数学问题。
3、界面： 友好的人机界面，交互式软件，提供在线帮助。
4、I/O： 具有强大的输入/输出功能，包括键盘、文件、数据、图形等
方式。

#### 主要功能

数值运算

绘图功能

控制系统工具箱

#### 变量管理与使用格式

##### 变量

MATLAB的变量名规则：变量名必须是<u>不含有空格</u>的单个词。

变量命名规则如下：

1. 变量名<u>区分字母大小写</u>，如：Items，items，itEms及ITEMS都是不同的变量；
2. 变量名最多<u>不超过19个字符</u>；第19个字符之后的字符将被忽略；
3. 变量名<u>必须以字母打头</u>，之后可以是任意字母、数字或下划线。如：x51483， a_b_c_d_e
4. 许多标点符号在MATLAB中具有特殊含义，所以变量名中<u>不允许使用这些标点符号</u>。

特殊变量：

| 特殊变量 | 取值                                                     |
| -------- | -------------------------------------------------------- |
| ans      | 用于结果的缺省变量名                                     |
| pi       | 圆周率                                                   |
| eps      | 计算机的最小数,当和1相加就产生一个比1大的数：2.2204e-016 |
| Inf      | 无穷大，如1/0                                            |
| i（和）j | 虚单位。$i=j=\sqrt{-1}$                                  |
| NaN      | 不定量，如0／0                                           |
| nargin   | 所用函数的输入变量数目                                   |
| nargout  | 所用函数的输出变量数目                                   |
| realmin  | 最小可用正实数: 2.2251e-308                              |
| realmax  | 最大可用正实数: 1.7977e+308                              |

##### 数据格式

存储和计算：均按双精度格式进行

显示：受format命令控制

| 命令           | 数据显示              | 说明             |
| -------------- | --------------------- | ---------------- |
| format long    | 35.83333333333334     | 16位小数         |
| format short e | 3.5833e+01            | 5位加指数        |
| format long e  | 3.583333333333334e+01 | 16位加指数       |
| format hex     | 4041eaaaaaaaaaac      | 十六进制         |
| format bank    | 35.83                 | 2个十进制小数位  |
| format +       | +                     | 正、负或零       |
| format short   | 35.8333               | 缺省显示 /format |

##### 使用格式

1. 变量 = 表达式
   例：a = 2*3；
   b = c+d；

2. 函数调用
   [o1，o2，…，on] = function ( i1，i2，…，im )

   输出变量列表			函数名		输入变量列表

#### 矩阵的输入、扩充、提取

（1）输入：很直观，分号、回车表示分行，逗号、空格表示分列。

例：键入 a=[1 2 3；4 5 6] 。则
$$
A=
\begin{bmatrix}
1 & 2 & 3\\
4 & 5 & 6
\end{bmatrix}
$$
（2）扩充：B=[a；[10 11 12]]。则
$$
B=
\begin{bmatrix}
1 & 2 & 3\\
4 & 5 & 6\\
10 & 11 & 12\\
\end{bmatrix}
$$


（3）提取：C = B(m:n，k:l)，取B的m至n行，k至l列

（4）产生向量：用冒号（：）产生向量

​			x=1:1:10，则 x = [1 2 3 4 ……10]

### 13.2 MATLAB基本运算

#### 标量的运算

+、-、*、/、^ 、sqrt、^(n/m)

#### 矩阵的运算

1. 加减：A+B、A-B，A与B的维数必须相同。

2. 乘法：C=A*B，A列 = B行，于是C行=A行，C列=B列

3. 除法（求逆）：A-1，inv（A），A为方阵
   左除：A\B = inv（A）\*B；A为方阵，A的列数=B的行数
   右除：C/A = C*inv（A）：A为方阵，C的列数=A的行数
   
4. 乘方：A^x，x为标量，A为方阵

5. 转置：A’，

6. 翻转：

   > flipud：上下翻转；
   > fliplr：左右翻转；
   > rot90：逆时针转90度。

7. 特征参数
   秩： rank（a）=3
   行列式：det（a）=27
   特征值： eig（a）=[-0.3884； 12.1229； -5.7345]
   特征向量：[x，y]=eig(a)，x为特征向量，y为特征值
   奇异值：svd（a）=[13.2015；5.4388；0.3760]
   特征多项式： poly（a）= 1.0000 -6.0000 -72.0000 -27.0000
   （按降幂排列的系数）
   范数： norm（a） = 13.2015，最大的奇异值
   迹： trace（a）=6，对角线元素之和

8. 列向量计算
   对矩阵的各列进行计算，结果为行向量。
   min（a）= [1 2 0]
   max（a）= [7 8 6]

#### 点运算

1. 点乘：C＝A.×B 表示 $c_{ij}=(a_{ij}*b_{ij})$

2. 点乘方：点乘方包括矩阵与常数和矩阵与矩阵的运算。

   * a.^3= $[a_{ij}^3]$，a矩阵的3次方――a矩阵的每个元素的3次方形成的新矩阵；
   * 3.^a= $[3^{a_{ij}}]$，3的a次方――新矩阵的每个矩阵元素都是以3为底，以A矩阵的对应元素为幂指数，形成的新矩阵。
   * a.^b= $a_{ij}^{b_{ij}}$ ，a的b次方――新矩阵的每个元素都以a的元素为底，以b的对应元素为幂指数。

3. 矩阵与标量的运算

4. 函数作用于矩阵

   > $sin(A)=sin(a_{ij})$

#### 多项式运算

1. 多项式表达

   > 各项系数按降幂形成的行向量：P=[1 2 3 4] Q=[1 2 1]

2. 多项式计算

   > 加：行向量相加，P+Q；减：行向量相减，P-Q；
   > 乘：conv（P，Q）；除：deconv（P，Q)； 微分：polyder（P）；

3. 多项式求根

   > roots(P)

#### 几个特殊矩阵

* eye(size(a))或eye(m,n)：生成单位阵
* ones(size(a))或ones(m,n)：生成全1阵
* zeros(size(a))或zeros(m,n)：生成全0阵

### 13.3 MATLAB编程

#### 基本术语和常见运算

##### MATLAB文件

1. m文件

   > 是普通的 ASCII 码构成的文件，以扩展名.m 结尾，只能由MATLAB语言所支持的语句组成；可以直接在工作空间中执行；执行时只需键入文件名，MATLAB会自动执行该M文件中的各条语句。

2. 函数文件

   > 除了MATLAB提供的函数，用户可以定义自己的函数。该定义
   > 要通过一个M文件来产生，称为函数文件。其扩展名也为.m。

3. 数据文件

   > MATLAB可以通过数据文件来保存或加载数据。

4. 低级文件输入输出

   > MATLAB 提供了基于C语言的低级文件I/O函数，可以读写任意文件格式。

   | 命令    | 说明                               |
   | ------- | ---------------------------------- |
   | fopen   | 打开文件                           |
   | fclose  | 关闭文件                           |
   | fscanf  | 按照格式要求从文件中读数据         |
   | fprintf | 按照格式要求把数据写到文件或屏幕上 |
   | fread   | 从文件中读二进制数据               |
   | fwrite  | 把二进制数据写到文件里             |

##### 关系运算与逻辑运算

1. 关系运算

   > \>、 <、>=、<=、 = =、 ~=
   > 若比较矩阵则是比较矩阵的对应元素（相当于点运算）

2. 逻辑运算

   > & 、 | 、 ~，xor

3. 循环语句格式

   1. for语句：从for开始，用end结束。格式：

      > for 循环变量＝s1:s2:s3
      > 	循环体
      > end
      > s1：循环变量初值
      > s2：循环变量增量，为1时可省略
      > s3：循环变量终值
      > for语句可以嵌套。
      
   2. while语句：从while开始，用end结束。格式：
   
      > while（条件表达式）
      > 	循环体
      > end
      > 循环体中必须包含使循环变量发生变化的语句。
      > while语句可以嵌套。
   

4. 条件语句格式

   if语句、if-else语句、if-elseif语句

#### M文件（函数）

##### 函数类型

（1）函数的组成
MATLAB函数由3部分组成：函数定义、注释、函数体。
function [输出参数表]= 函数名(输入参数表)；%注释—通常在函数体的首行加上对函数整体功能的解释。
函数的命名：一般与函数名一致，必须以字母开头，其余部分可以是字母、数字和下划线的组合。如果文件名与函数名不同则必须使用文件名而不是程序内部定义的函数名（系统默认）。

（2）函数体定义的主要方式

| 函数体                          | 注释          |
| ------------------------------- | ------------- |
| function y=average(x)           | %单输入单输出 |
| function [a,b,c]=average(x,y,z) | %多输入多输出 |
| function average(x)             | %有输入无输出 |
| function []=average(x)          | %有输入无输出 |
| function [a,b]=average()        | %无输入有输出 |

**注意：传递给函数的变量不必和函数定义行中的参数同名。**

（3）函数的注意问题

MATLAB函数需要注意的问题：函数名识别、函数参数传递、函数工作空间。

1. 函数名识别：函数可以在命令行中执行，也可以在其他M文件中调用。如果一个函数名被调用，则系统通过一定的过程来确定使用哪个函数：检查是否有同名变量；检查是否为子函数；检查是否是私有目录中的函数；是否在搜索对象路径中。
2. 函数参数传递：MATALB通过内存的引用来传递参数。
3. 函数工作空间：函数在执行时都拥有自己的内存空间，可以访问工作空间的变量和其他函数工作空间中的变量。

（4）函数的变量

变量创建的特点：

1. 不需要声明变量的类型与大小，用表达式右侧的确定值来定义；
2. 对变量赋值既是创建变量，对既存的变量改写变量值；
3. 变量的定义和文件名相同，32字符为止有效。

全局变量和局部变量的定义：

1. 各函数都定义自己的局部变量，既使是同名变量也相互独立
2. 如果在函数及基本工作空间中都声明了全局变量，则都可以访问；
3. 基本工作空间中不单独声明全局变量的情况，则不可以访问。

##### 参数传递

参数中变量传递的个数：以varargin或varargout作为输入或输出参数，表示可以具有多个输入或输出参数。下面的例子中，可以接受任意多个元素输入。

#### MATLAB的外部数据操作

##### 外部数据操作

```matlab
FID= fopen(filename,permission) %打开filename指定的文件，permission，r为读，w为写，t是使用文本文件形式打开
fprintf(fid, format, variables)`%写入文件内容，format用来指定数据输出时采用的格式。
A=fscanf(fid,format,size)`%将指定的句柄fid中的内容按照format的格式读取到变量A中，读取的数量由size指定。
Format数据输出格式：
%d 整数
%e 实数：科学计算法形式
%f 实数：小数形式
%g 由系统自动选取上述两种格式之一
%s 输出字符串
```

##### 使用窗口操作实现文件数据读取

手工操作

##### 获取用户输入

1. input函数：显示提示信息，获取用户的键盘输入；
2. pause函数：暂停程序的运行，直到用户按下任意键；
3. 建立图形用户界面（GUI）；
4. echo on/off: 显示/关闭程序执行时的输出。

##### 日期和时间的使用

（1）日期和时间的表示格式

常用的3种时间及日期数据格式：

| 日期时间格式          | 举例                   |
| --------------------- | ---------------------- |
| 日期字符串（date）    | 13-Jan-2008            |
| 连续的日期数值（now） | 732691                 |
| 日期向量（clock）     | 2008 9 17 16 01 11.512 |

（2）获取当前日期和时间的函数

* date函数 %按照日期字符串格式返回当前系统日期；
* now函数 %按照连续日期数值格式返回当前系统时间；
* clock函数 %按照日期向量格式返回当前系统时间。

（3）日期格式的转换

* datestr(D,F)函数：将任意格式的日期和时间D按照指定的输出形式F，转换为字符串形式；
* datenum(D)函数：将任意格式的日期和时间D转换为数值格式；
* datevec(D)函数：将任意格式的日期和时间D转换为向量格式。

（4）程序中的计时函数

* cputime函数：返回MATLAB启动以来的CPU时间；
* tic/toc函数：分别放置在程序的首尾，返回程序执行的总时间；
* etime(t1,t2)函数：计算两个日期时间向量的时间差（结合clock函数）。

### 13.4 MATLAB绘图命令

MATLAB具有很强的绘图功能，可以绘制多种二维、三维图形，也可以进行动画演示。

#### plot命令

最常用的绘图命令

将各个数据点用直线连接绘制二维图形。plot命令打开一个默认的图形窗口，自动将数值标尺标注加到两个坐标轴上。如果已经存在一个图形窗口，plot命令将刷新当前窗口的图形。

调用格式：plot（x1，y1，‘参数1’， x2，y2，‘参数2’...）

#### 对数坐标图

* semilogx命令：x 轴为以10为底的对数坐标，y 轴为线性坐标。
* semilogy命令：y 轴为以10为底的对数坐标，x 轴为线性坐标。
* loglog命令 ：双对数坐标，均以10为底。

#### 其他二维图形

##### 极坐标图

polar命令：polar(theta，rho，参数)；

theta和rho分别为辐角和向径的向量，参数项同plot。辐角的单位为弧度。

##### 饼图

饼图在统计中常用来表示各因素所占的百分比示例。
格式：pie（x） 或 pie（x，explode）

##### 梯形图

梯形图可以用来表示系统中的采样数据。
格式：stairs（x）或stairs（x，y）；x、y均为向量

##### 直方图

格式：bar（x，width）

#### 三维图形

本节只介绍基本三维图形的plot3命令。

格式：plot3 (x1，y1，z1，‘参数1’， x2，y2，z2，‘参数2’...)

#### 图形窗口的分割与子绘图命令

MATLAB的绘图指令可以将绘图窗口分割成几个区域，在各个区域中分别绘图。
命令subplot（m，n，p）将当前绘图窗口分割成m行n列，并指定第p个编号的区域为当前绘图区域。区域的编号原则是“先上后下，先左后右”。

#### 与绘图有关的其他命令

##### axis命令

格式： axis（[xmin xmax ymin ymax]）
将图形的x轴范围限定在[xmin ，xmax]之间，y轴的范围限定在[ymin，ymax]之间。

##### grid命令

* grid on －在所画的图形中添加网格线；
* grid off － 在所画的图形中去掉网格线。

##### 文字标注

MATLAB提供了有关图形的标题、坐标轴标注等指令。

* title（‘字符串’）－ 图形标题
* xlabel（‘字符串’）－ x轴标注
* ylabel（‘字符串’）－ y轴标注
* text（x，y，‘字符串’）－ 在坐标（x，y）处标注说明文字
* gtext（‘字符串’）－ 用鼠标在选定处标注说明文字

##### 图例注解

当在一个图上画有多条曲线时，为区分各个曲线，MATLAB提供了图例注解说明命令legend 。

格式：legend（字符串1，字符串2，…，参数）

## 期末相关

复习参考资料（2019年）：https://www.cnblogs.com/FUJI-Mount/p/12134002.html

以及”课堂练习“

